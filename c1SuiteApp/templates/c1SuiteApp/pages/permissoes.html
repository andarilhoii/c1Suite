{% extends "base.html" %}
<!-- bloco que permite alterar o título desta pagina -->
{% block title %} Helius - Permissões {% endblock title%}

<!-- inicio do bloco que permite alterar o conteúdo dessa página-->
{% block content %}
<div class="cad-container cad-container-permissoes">
    <h1>Lista de Permissões</h1>

    <!-- Formulário para criar/editar permissoes -->
    <form method="POST" class="cad-form">
        {% csrf_token %}

        <!-- id oculto para edição -->
        <input type="hidden" name="id" value="{{ permissoes_editar.id|default_if_none:'' }}">
        <!-- informa à view que esta requisição é de salvar (create/update) -->
        <input type="hidden" name="acao" value="salvar">

        <label for="nome">Nome:</label>
        <!-- preenchido quando estiver editando um permissão -->
        <input type="text"
               name="nome"
               id="nome"
               value="{{ permissoes_editar.nome|default_if_none:'' }}"
               required>
        <br>

        <label for="descricao">Descrição:</label>
        <textarea name="descricao"
                  id="descricao">{{ permissoes_editar.descricao|default_if_none:'' }}</textarea>
        <br>

        <!-- botões principais do formulário -->
        <div class="cad-form-buttons">
            <button type="submit" class="btn-small btn-wide">Salvar</button>

            <!-- limpar: reseta os campos nome e descricao para vazio
                 (como a página é carregada com eles em branco, o reset limpa) -->
            <button type="reset" class="btn-small btn-wide btn-secondary">Limpar</button>

            <!-- voltar para a página principal -->
            <button type="button"
                    class="btn-small btn-wide btn-secondary"
                    onclick="window.location.href='{% url 'home' %}'">
                Voltar
            </button>
        </div>
    </form>
    <hr>

    <!-- Listagem dos permissões -->
    <ul class="cad-list cad-list-permissoes">
        <!-- cabeçalho das colunas -->
        <li class="cad-header">
            <div>Nome</div>
            <div>Descrição</div>
            <!--<div class="col-acoes">Ações</div>-->
        </li>

        {% for permissao in permissoes %}
            <li class="cad-row">
                <!-- coluna nome (sem negrito específico) -->
                <div class="col-nome col-nome-permissoes">
                    {{ permissao.nome }}
                </div>

                <!-- coluna descrição -->
                <div class="col-descricao">
                    {{ permissao.descricao|linebreaksbr }}
                </div>

                <!-- coluna ações -->
                <div class="col-acoes">
                    <form method="post" style="display:inline-flex; gap: 0.6rem; align-items: center;">
                        {% csrf_token %}
                        <input type="hidden" name="id" value="{{ permissao.id }}">
                        <input type="hidden" name="acao" value="excluir">

                        <!-- link para carregar dados no form -->
                        <a href="?editar={{ permissao.id }}" class="btn-small btn-wide">Editar</a>

                        <button type="submit"
                                class="btn-small btn-wide btn-danger"
                                onclick="return confirm('Confirma a exclusão desta permissão?');">
                            Excluir
                        </button>
                    </form>
                </div>
            </li>
        {% empty %}
            <li>Nenhuma permissão cadastrada.</li>
        {% endfor %}
    </ul>
</div>
{% endblock content %}


